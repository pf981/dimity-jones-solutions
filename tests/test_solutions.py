import hashlib
import importlib
import pytest


hashes = [
    "9030eb24f46a8069d8c005619f0631a80967b0ec3af8deb1bab3e3c3e9245b92",  # Raw file
    "d1d947630fedcbeb090f172440c7d3cbb5c15c4f6374655e16db21ff375d460a",
    "d5692933375a798f0916f2556233329d3c45458a80dac272560d6c4c981f79a1",
    "2f2c81c6f85a957ec494899f0e1ca52a3d4957aa5f71ed115db48657e62742bc",
    "37f48587ec073d5d5788afc50b59c9f12d393b9111c492b845d390bf5800ecae",
    "79c920c8074fb613a3818e53ed7d6d053faa6de055f79f955c886b9ffbc8ebcb",
    "db01cf9dffa371f7498e44dc9c848c253b2ee83044e8183303ac4a9d4d64b2e0",
    "972bc5851d702addbd9cdd160e168315be6ea88c5c8e81b310a3ceb32a689297",
    "b4abcd93389e41f2f2bff9bccf3037122d54e6a64a64f8385f1c66da8363f883",
    "1d2482587a0b9e3a9fbcb9c6ce6f56ae7b8563e3fb78ba1c921d8b1d7377650b",
    "c5932def6c1c184b14fe2387d21da09ee9e9b144bdeb6f0322bab1561c628e38",
    "cb1d8a829b95a6ba1318b362fc48b027e6d48769db882cf1dd845d0f840ca5e0",
    "5b5d1473979033f7ccbfc4f64a8d0a8de3943b8082a65f019a01ff6b94eea7f7",
    "278a4db978c130e259f2e367c8ecc7f448da64a0a1e43f4ff1604e62300407de",
    "c598ee4674a4675b90e33c9e7e57068e8fe082d4967737e7a2a2112101679b2b",
    "fc25683f46b31a48639b79da14073ca793704226aa29d2784ad2ebc55f6908c0",
    "64bbddb13c41af8799adf1cc0c69cac5a9c9dee2f23c77c01bd8136c9c7db2fa",
    "c47d750614ba6c8aa8f0d24f7d18e7765113b77e4d4f1fa0bfc44680f2f3b28c",
    "7105d47daba423a1cdb2f2b8abcc405315000cf47f7f8ab68d57fb61b75708d6",
    "5318d953d320308488f3169b54f291c129dd152283ba6525b47702305f33024f",
    "38506fee17965be00549defb385e4a899ea3615162ebb57303453af45214a30c",
    "c7a4f8b1ce0aacac2057927f572f05d033adb15a2e56666784c853460cff85c3",
    "d5a79a005109e66ef8f54015acbd3ccf7cdad096051253a858391a0765e55259",
    "fcb43ef61ac0c821e6c217d79edd755d3558461cf8eddc3c27f615a161cd9cf3",
    "50a9cc50c5e03c3f9b70ff2723879c178a3f15f57dc9488deb9d331a788fefe9",
    "426ebf7b2c5d3d8594a84f4233fc0bae29723dda6a65441d6d3062e0410c1a94",
    "1b30eb4d9e6430626fddefaaf706ebdd5e15135976d8f4bf9588264f07bd9bfc",
    "3f7f7a872ae3405840c1df6704e1c4d93b4460bf4000e9d506f7863227362709",
    "18a0ce0dcf5cd2daccc8a88f5dddf6b5c503d509e89dd281de15db1b7c8f50e7",
    "1aab6e10c18c6b19ce104c3e67b5fc91e0d3e5a1ae0d76e5c918298e90f7b6e5",
    "feb67f0c1e92a3bb1adf897b6946414762785ade51e1cf2ca12794203dc29c32",
    "15ba8d59c51ff14e58dffe5310910813e691aa3f630a05e18e3127bf4ef66bf1",
    "a57b55f8adc9fb67847e8b9b37b3fe23856653fb2b3517c8b8d27207e09e0957",
    "2f3e9560f3783bb01dedd1d9527ef10a8eb90375b8db685dc759b80892865af2",
    "a0fb7907b0c92ffbaa1f66dcff6e4777d5da82c399cbbfbbac2be754058789f2",
    "a19b6ea995aa75fe9ff4bc79a875953597b156d8f5a5fc73812bea795db9ebbb",
    "60e2dd81ac3ba1dd0d0e326c3e0467a6a82f99166947efab98127e7977e71063",
    "0ac2e73e7a003e35504185a6172e545f733914e01da349355d7fe85161d7bf83",
    "dc69681e8080e7848b8af2b5201e46c63d7926ba6603d4c796a08885bc605945",
    "b989ab7781d13702be9fd51fe04c6d149a8567b2cc5cffb749408e3244734fd8",
    "64ba6913fad80d3333cfbb3fbb4a827da121d0e0eb260f807f17e69f40508990",
    "6910113c21eb1f3943fde1bb19046aa7d55fa51b628b6059973ed0bd0b684d04",
    "7605d3b559d1ab120d196d5392b0aa464665904d1ba69c4c566e4739fc8a8108",
    "ece89db593dd54f132a848b2b20531a7882c9e6f9ad0712ba5df473348f40fdc",
    "01396e63e683fe672ceac8c81ce8dfd7cb3a3b2237aed2f681561ff654b269b5",
    "e6fc75610e97db2af821f5a7cd9eac2c7ef2cadfa5d2a8f12a67a0e7599c7d43",
    "eb476713d43e3dc4532895511d213f1890228323529edf69720fb50757df0758",
    "7d0ae997b6d8a054315dda124ba074f965ffa73d1043ffd38b985f21434ecaf7",
    "fa0cc8df929ae1e87c99b3fe43d7b547a6d849325008f541e867212c58ec973b",
    "05825854e0e237b2f32e673b39da90925e4a3dfa5d0e76b9013d268e5cd6507e",
    "362f538d1517cce6b122c32d218c9417d8d447f4750bbc48f01895c6d9b750d9",
    "ab07c13f57009de48f36a56e419ad6982da3932b6f53fef227ec7e2e072b6641",
    "9b92ad7b755256ad2cfc4e8c4679b98ec7111b7ab3b5855b50d39706a9cea7f4",
    "1b7a7e431f6f914dfd1c2ebde3e31848c05b1a455ad4913683efbb2141817a28",
    "f2183f02e375384e4092536bbe30e5f7042e81b8a39338d1d044dca9a78bce87",
    "3e4143aa14306abbd1049accd910e418dc6d78144a474c97d8129c611b2f560c",
    "f008d8355867718632df5fd9c8b8c46f26a0a0d622bed07c841fc854f0a7a2fc",
    "1410ae4acc2cb73278a4458ffa230f8b5344f3bf9ca81814973d574ebb540df5",
    "0d0fc4ff589b35f1b9b5d0c91edfd41a2cadad633b464cd44311021239ce8c12",
    "276771ecb72d770f706329da7d5a4a99cba55a5c2bfd2c5233cc68719ea16668",
    "5197db56ba583bf5dbf4ac5778cae11ce3aa9b4643957d048517f2e30bb48eb2",
    "50e5be2ee4a8265722bd71efa3c5f4839a87d8dff8fc97cd3c99c757b3356344",
    "057e8c432f8af63dc1857fced12220559856bc656e8c320f71bf8916ddf34509",
    "6329cdc40c31a2d4b8637b884b3339b62f20867f377ec9524b37dd8e9e630064",
    "735934920ead38c385a4dda43beebc1588abe8c90b265b023575a7b051d37c28",
    "20c28a7e9410ed9bbf662955122e10e3f5cacf74b4e10b86b000009f01d7e81c",
    "72fe073a94a21464d552eba988abc2b56439c5a57171ad9176b121cd70173b8a",
    "4c6ea8412763fb467265353101242a9747935e7393de219afaec1ba2de40654e",
    "e2a26c0fb0e1aefee2aeb7f34d49997375f11519683a5bb60c9521ee5f729c30",
    "f14d63135ed49073780300e14073e06809cfb9eacd8dd045e7e0e2a91e43b32b",
    "4905fc22c9483965db230a6ac660773ed4b55f2cc7b0d71107bffb756a326809",
    "7f65f72b597bcfe4e9434c39b953fb1aa06b6751b5b4ebe9db953b9080a77cce",
    "dafd81d6875d33b31b8c3fa03648751db02d708ce17a9a852383eccf035af508",
    "51c5d3d5b1c69f5bed4ae2c40ed689133797cec2214350092bbcfb29b33bacf3",
    "a7aba5d8803f8cc7750fb476b930c8f2e1a2125c0d2555ae7bbb985ff5c5ce70",
    "e47130a4d953b86d68a22cb1bd4a080be21ad2707ff95e7262f59c1fa1eed2da",
    "e5465d778fd48b724d9b5ddba23130c85cba329d39cef38f397d9fc439e64611",
    "2f654c6e0896b152011d173e638892f2ba4b6cde34391daae24e1c5ccf8b2d3b",
    "ac0192e5556f1d8f583418141db15809509d1c5648f601c0f0c8a0185d67d2ea",
    "66bf2a5964c904cea4d13b2913b82d7d9470f4899532bbf707d73895bc12a551",
    "cb314856717a527733ffb4e9b46cb04a5ce2d3a675ac9077ab9e1410a1d81171",
    "32d13b1f2d4f01bc6e946dc3342f556e390a82c3df031b0dc0ddf639d7444856",
    "ccb00b1f84495e8298eb82909447d45d2c7bc5f318ea9bf5f50f668b15af91d5",
    "d4d68c2fbeb0c76111f88ccb1aa5c461544eb72057d975b24456d291f1b90042",
    "6d19a77021d2fa19957951fd7f973f577a81c950040e7a2165f2a6ca3e3b2495",
    "c5ab5ec6d5754aab822201d1f6b57e1377622abd4d4f2c5b58ba1984e16e65b7",
    "d7a036b2b8302b900a0b6c52eeb7d832e7fba53f01e8619b0bbf58c02211fed8",
    "e255ad75bdfc339006a2de02996c3a403a49518589b8cb8529075f5cb6cb70a0",
    "9d25b68a462017909c4b9f040c2efa803525e64cf373643b22fa096653306f36",
    "9920b2704b4cb554b2cb9be1b939d8d2aa1d64ce8784c7d2176585201f4f5663",
]


@pytest.mark.parametrize("chapter, expected_hash", enumerate(hashes))
def test_solutions(chapter, expected_hash):
    try:
        module = importlib.import_module(f"solutions.{chapter:02d}")
    except ModuleNotFoundError:
        pytest.skip(f"Solution not implemented {chapter:02d}.py")
    decrypt = module.decrypt

    assert decrypt.chapter == chapter

    path = decrypt.write_chapter()
    decrypt.write_one_chapter()

    with open(path, "br") as f:
        h = hashlib.file_digest(f, "sha256").hexdigest()
    assert h == expected_hash
